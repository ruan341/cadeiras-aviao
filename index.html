<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Mapa de Poltronas A350</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 10px;
  text-align: center;
}

h1 { margin: 10px 0; }
h2 { margin: 25px 0 10px; }

.row {
  display: flex;
  justify-content: center;
  margin-bottom: 6px;
}

.seat {
  width: 36px;
  height: 36px;
  margin: 3px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  color: #fff;
  cursor: pointer;
}

.first { background: #8e44ad; }
.business { background: #2980b9; }
.premium { background: #16a085; }
.economy { background: #27ae60; }

.blocked {
  background: #7f8c8d;
  cursor: not-allowed;
}

.selected {
  outline: 3px solid #f1c40f;
}

.aisle {
  width: 20px;
}

button {
  margin: 25px;
  padding: 14px 28px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  background: #2c3e50;
  color: #fff;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>Airbus A350 – Seleção de Poltronas</h1>
<div id="mapa"></div>

<button onclick="confirmar()">Confirmar Poltrona</button>

<script>
const FORM =
"https://docs.google.com/forms/d/e/1FAIpQLSf0wYXE6i7JPQCBkKR5LqyRdwxRscpSmclDMQJXTs_llonIbA/viewform?usp=pp_url&entry.1796450485=SEAT_AQUI";

const API =
"https://script.google.com/macros/s/AKfycbxasFqWB5ZLfWHbZBt8RfaKlFwxo8zwHG_b-4OBkvo6NUz8DH7rgmAB57_k2aeT_RqI8w/exec";

let escolhida = null;

function seatDiv(id, classe, ocupadas) {
  const s = document.createElement("div");
  s.innerText = id;

  if (ocupadas.includes(id)) {
    s.className = "seat blocked";
  } else {
    s.className = "seat " + classe;
    s.onclick = () => {
      document.querySelectorAll(".seat")
        .forEach(x => x.classList.remove("selected"));
      s.classList.add("selected");
      escolhida = id;
    };
  }
  return s;
}

function criarBloco(titulo, inicio, fim, layout, classe, ocupadas) {
  const mapa = document.getElementById("mapa");
  const h = document.createElement("h2");
  h.innerText = titulo;
  mapa.appendChild(h);

  for (let f = inicio; f <= fim; f++) {
    const r = document.createElement("div");
    r.className = "row";

    layout.forEach(item => {
      if (item === "|") {
        const a = document.createElement("div");
        a.className = "aisle";
        r.appendChild(a);
      } else {
        r.appendChild(seatDiv(f + item, classe, ocupadas));
      }
    });
    mapa.appendChild(r);
  }
}

fetch(API)
.then(r => r.json())
.then(ocupadas => {

  criarBloco(
    "First Class",
    1, 2,
    ["A","|","D","G","|","K"],
    "first",
    ocupadas
  );

  criarBloco(
    "Business Class",
    3, 8,
    ["A","|","D","G","|","K"],
    "business",
    ocupadas
  );

  criarBloco(
    "Premium Economy",
    9, 12,
    ["A","B","|","D","E","F","|","H","J"],
    "premium",
    ocupadas
  );

  criarBloco(
    "Economy",
    13, 35,
    ["A","B","C","|","D","E","F","|","G","H","J"],
    "economy",
    ocupadas
  );
})
.catch(() => {
  criarBloco("Economy",13,35,["A","B","C","|","D","E","F","|","G","H","J"],"economy",[]);
});

function confirmar() {
  if (!escolhida) {
    alert("Selecione uma poltrona!");
    return;
  }
  window.location.href =
    FORM.replace("SEAT_AQUI", escolhida);
}
</script>

</body>
</html>
