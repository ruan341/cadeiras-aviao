<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Mapa de Poltronas – Airbus A350</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial, sans-serif;
  background:#f2f2f2;
  margin:0;
  padding:0;
  text-align:center;
}

h1{margin:20px 0;}
h2{margin:10px 0;}

.section{
  margin:25px 0;
}

.row{
  display:flex;
  justify-content:center;
  margin-bottom:6px;
}

.seat{
  width:36px;
  height:36px;
  margin:3px;
  border-radius:6px;
  font-size:11px;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  user-select:none;
}

.first{background:#8e44ad;}
.business{background:#2980b9;}
.economy{background:#27ae60;}

.free{cursor:pointer;}
.blocked{background:#7f8c8d; cursor:not-allowed;}
.selected{outline:3px solid #f1c40f;}

.aisle{width:18px;}

button{
  margin:25px;
  padding:12px 28px;
  font-size:16px;
  border:none;
  border-radius:6px;
  background:#2c3e50;
  color:#fff;
  cursor:pointer;
}

button:hover{background:#1a252f;}

@media (max-width:600px){
  .seat{width:28px;height:28px;font-size:9px;}
}
</style>
</head>

<body>

<h1>Selecione sua Poltrona – Airbus A350</h1>

<div class="section">
  <h2>First Class</h2>
  <div id="first"></div>
</div>

<div class="section">
  <h2>Business Class</h2>
  <div id="business"></div>
</div>

<div class="section">
  <h2>Economy Class</h2>
  <div id="economy"></div>
</div>

<button onclick="confirmSeat()">Confirmar Poltrona</button>

<script>
/* LINKS */
const FORM_LINK =
"https://docs.google.com/forms/d/e/1FAIpQLSf0wYXE6i7JPQCBkKR5LqyRdwxRscpSmclDMQJXTs_llonIbA/viewform?usp=pp_url&entry.1796450485=SEAT_AQUI";

const API_URL =
"https://script.google.com/macros/s/AKfycbxasFqWB5ZLfWHbZBt8RfaKlFwxo8zwHG_b-4OBkvo6NUz8DH7rgmAB57_k2aeT_RqI8w/exec";

let selectedSeat = null;

/* FUNÇÃO DE CRIAÇÃO */
function createSeats(containerId, start, end, layout, cls, ocupadas){
  const c = document.getElementById(containerId);

  for(let r=start;r<=end;r++){
    const row = document.createElement("div");
    row.className="row";

    layout.forEach(l=>{
      if(l==="aisle"){
        const a=document.createElement("div");
        a.className="aisle";
        row.appendChild(a);
      }else{
        const id = r + l;
        const s=document.createElement("div");
        s.innerText=id;

        if(ocupadas.includes(id)){
          s.className="seat blocked";
        }else{
          s.className=`seat free ${cls}`;
          s.onclick=()=>{
            document.querySelectorAll(".seat.free")
              .forEach(x=>x.classList.remove("selected"));
            s.classList.add("selected");
            selectedSeat=id;
          };
        }
        row.appendChild(s);
      }
    });

    c.appendChild(row);
  }
}

/* CARREGA BLOQUEIOS */
fetch(API_URL)
.then(r=>r.json())
.then(ocupadas=>{
  if(!Array.isArray(ocupadas)) ocupadas=[];

  // FIRST 1–2 (1-1)
  createSeats("first",1,2,["A","aisle","F"],"first",ocupadas);

  // BUSINESS 3–8 (2-2-2)
  createSeats(
    "business",
    3,8,
    ["A","B","aisle","D","E","aisle","F","G"],
    "business",
    ocupadas
  );

  // ECONOMY 9–30 (3-3-3)
  createSeats(
    "economy",
    9,30,
    ["A","B","C","aisle","D","E","F","aisle","G","H","J"],
    "economy",
    ocupadas
  );
})
.catch(()=>{
  alert("Erro ao carregar poltronas");
});

/* CONFIRMAR */
function confirmSeat(){
  if(!selectedSeat){
    alert("Selecione uma poltrona!");
    return;
  }
  window.location.href =
    FORM_LINK.replace("SEAT_AQUI", selectedSeat);
}
</script>

</body>
</html>
