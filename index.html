<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>A350 – Seleção de Poltronas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;text-align:center;background:#f2f2f2;margin:0}
.seat{width:34px;height:34px;margin:3px;border-radius:6px;
display:inline-flex;align-items:center;justify-content:center;
font-size:11px;color:#fff}
.free{background:#27ae60;cursor:pointer}
.blocked{background:#7f8c8d}
.selected{outline:3px solid #f1c40f}
.row{margin-bottom:6px}
</style>
</head>

<body>
<h1>Airbus A350</h1>
<div id="map"></div>
<button onclick="go()">Confirmar</button>

<script>
const FORM =
"https://docs.google.com/forms/d/e/1FAIpQLSf0wYXE6i7JPQCBkKR5LqyRdwxRscpSmclDMQJXTs_llonIbA/viewform?usp=pp_url&entry.1796450485=SEAT_AQUI";

const API =
"https://script.google.com/macros/s/AKfycbxasFqWB5ZLfWHbZBt8RfaKlFwxo8zwHG_b-4OBkvo6NUz8DH7rgmAB57_k2aeT_RqI8w/exec";

let sel=null;

function draw(ocupadas){
  const m=document.getElementById("map");
  for(let r=9;r<=12;r++){
    const d=document.createElement("div");
    d.className="row";
    ["A","B","C","D","E","F"].forEach(l=>{
      const id=r+l;
      const s=document.createElement("div");
      s.innerText=id;
      if(ocupadas.includes(id)){
        s.className="seat blocked";
      }else{
        s.className="seat free";
        s.onclick=()=>{
          document.querySelectorAll(".seat.free")
            .forEach(x=>x.classList.remove("selected"));
          s.classList.add("selected");
          sel=id;
        };
      }
      d.appendChild(s);
    });
    m.appendChild(d);
  }
}

fetch(API)
.then(r=>r.json())
.then(draw)
.catch(()=>draw([]));

function go(){
  if(!sel){alert("Selecione uma poltrona");return;}
  location.href=FORM.replace("SEAT_AQUI",sel);
}
</script>
</body>
</html>
